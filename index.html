<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AR Erde</title>

  <!-- A-Frame & AR.js -->
  <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@ar-js-org/ar.js@latest/aframe/build/aframe-ar.min.js"></script>

  <!-- Styles -->
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <a-scene embedded
           device-orientation-permission-ui="enabled: false"
           vr-mode-ui="enabled: false"
           arjs="detectionMode: mono; matrixCodeType: 3x3; trackingMethod: best; displayDeviceOrientationPermissionPrompt: false; deviceOrientationEnabled: false;">

    <a-marker preset="hiro">
      <!-- Erde -->
      <a-entity id="earth-container">
        <a-entity id="earth" gltf-model="assets/earth.glb"
                  position="0 0 0" scale="0.01 0.01 0.01"
                  animation__grow="property: scale; to: 1 1 1; dur: 2000; easing: easeOutElastic">
        </a-entity>
      </a-entity>

      <!-- Info-Fenster -->
      <a-entity id="info-box" position="0 1 -1" visible="true">
        <a-plane id="info-bg" height="1" width="2.2" color="#D8F3DC" opacity="0.9" position="0 0 -0.01"
                 class="clickable"
                 animation__pulse="property: material.color; from: #D8F3DC; to: #B7E4C7; dir: alternate; dur: 1000; loop: true">
        </a-plane>

        <a-entity position="0 0.35 0.06"
                  text="value: Willkommen! WÃ¤hle eine Szene, um zu starten.; align: center; color: #1B4332; width: 2; font: exo2bold;">
        </a-entity>

        <a-entity id="btn-close-info" geometry="primitive: plane; height: 0.4; width: 1.3"
                  material="color: #95D5B2; transparent: true" position="0 -0.2 0.08"
                  class="clickable">
          <a-entity position="0 0.1 0.15"
                    text="value: Verstanden; align: center; color: #1B4332; width: 2.5; font: exo2bold;">
          </a-entity>
        </a-entity>
      </a-entity>

      <!-- Szenenauswahl -->
      <a-entity id="scene-selection" visible="false">
        <a-entity id="scene-bike" gltf-model="assets/bike.glb" position="-1 0.5 -2" scale="0.5 0.5 0.5"></a-entity>
        <a-entity id="scene-salad" gltf-model="assets/salad.glb" position="0 0.5 -2" scale="0.5 0.5 0.5"></a-entity>
        <a-entity id="scene-water" gltf-model="assets/water.glb" position="1 0.5 -2" scale="0.5 0.5 0.5"></a-entity>
      </a-entity>
    </a-marker>

    <a-camera cursor="rayOrigin: mouse" raycaster="objects: .clickable" look-controls="enabled: false"></a-camera>
  </a-scene>

  <!-- JS-Module -->
  <script type="module" src="scripts/main.js"></script>

  <!-- ðŸ’£ Hartes Info-Fenster-SchlieÃŸen -->
  <script>
    window.addEventListener("DOMContentLoaded", () => {
      const infoBox = document.querySelector("#info-box");
      const sceneSelection = document.querySelector("#scene-selection");

      const killInfo = () => {
        if (infoBox && sceneSelection && infoBox.getAttribute("visible") === "true") {
          infoBox.setAttribute("visible", "false");
          sceneSelection.setAttribute("visible", "true");
          console.log("ðŸ”¥ HARD CLOSE: Info weg, Szenenauswahl aktiv");
          document.removeEventListener("touchstart", killInfo);
          document.removeEventListener("click", killInfo);
        }
      };

      document.addEventListener("touchstart", killInfo, { once: true });
      document.addEventListener("click", killInfo, { once: true });
    });
  </script>
</body>
</html>